import{r as l,j as e,H}from"./app-D6kKXF99.js";import{A as U}from"./app-layout-C2jjdTT_.js";import{u as z,X as W}from"./NotificationContainer-BT-c5sXX.js";import{T as $,C as K}from"./ConfirmDialog-aofYRKw4.js";import{I as B}from"./ImagePreviewModal-C2aUk5hk.js";import{P as G}from"./plus-UnDe78EH.js";import{I as J}from"./image-Czw9ajn-.js";import{S as Q}from"./square-pen-CKOLoaH4.js";/* empty css            */import"./utils-ALYWs1Gd.js";import"./index-DCUGYyOh.js";import"./button-B5k_BnNa.js";import"./index-BpwMDNmh.js";import"./index-VjNSY46-.js";import"./index-CjaKH9ar.js";import"./index-Fv__CLny.js";import"./proxy-hi-s8ZU_.js";import"./index-w_94M6Cx.js";import"./index-CMWG4mbA.js";import"./book-open-DKjhm4ZH.js";import"./megaphone-Cbc3w7gv.js";import"./landmark-Cm81SObB.js";import"./tag-2FDY3cPo.js";import"./users-DcN1oeZo.js";import"./chevron-right-DvLDHTaz.js";import"./download-DUxR2ONm.js";const V=()=>{const{addNotification:o}=z(),[b,T]=l.useState([]),[D,_]=l.useState(!0),[A,d]=l.useState(!1),[y,v]=l.useState(!1),[n,N]=l.useState(null),[x,p]=l.useState({open:!1,id:null}),[L,w]=l.useState(!1),[g,S]=l.useState({open:!1,url:"",title:""}),[r,i]=l.useState({title:"",subtitle:"",highlight:"",description:"",cta_text:"",cta_link:"",ordre:"0",actif:!0}),[C,k]=l.useState(null),[E,h]=l.useState(null);l.useEffect(()=>{f()},[]);const f=async()=>{try{const s=await(await fetch("/admin/api/slides")).json();console.log("Slides loaded:",s.data),T(s.data||[])}catch(t){console.error(t),o("error","Impossible de charger les slides")}finally{_(!1)}},m=()=>{i({title:"",subtitle:"",highlight:"",description:"",cta_text:"",cta_link:"",ordre:"0",actif:!0}),k(null),h(null),N(null)},F=t=>{i({title:t.title||"",subtitle:t.subtitle||"",highlight:t.highlight||"",description:t.description||"",cta_text:t.cta_text||"",cta_link:t.cta_link||"",ordre:String(t.ordre),actif:t.actif}),h(t.image_url),N(t.id),d(!0)},M=async t=>{t.preventDefault(),v(!0);try{const s=document.querySelector('meta[name="csrf-token"]')?.content??"",a=new FormData;Object.entries(r).forEach(([u,I])=>{u==="actif"?a.append(u,I?"1":"0"):a.append(u,I??"")}),C&&a.append("image",C);const c=n?`/admin/api/slides/${n}`:"/admin/api/slides",O="POST";n&&a.append("_method","PUT");const j=await fetch(c,{method:O,headers:{"X-CSRF-TOKEN":s,"X-Requested-With":"XMLHttpRequest"},body:a});if(!j.ok){const u=await j.json();throw new Error(u.message||"Erreur de sauvegarde")}const X=await j.json();o("success",X.message||(n?"Slide modifié avec succès":"Slide créé avec succès")),await f(),d(!1),m()}catch(s){console.error(s),o("error",s instanceof Error?s.message:"Impossible de sauvegarder le slide")}finally{v(!1)}},P=t=>{p({open:!0,id:t})},R=async()=>{if(x.id){w(!0);try{const t=document.querySelector('meta[name="csrf-token"]')?.content??"",s=await fetch(`/admin/api/slides/${x.id}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest"}});if(!s.ok){const c=await s.json();throw new Error(c.message||"Erreur de suppression")}const a=await s.json();o("success",a.message||"Slide supprimé avec succès"),await f(),p({open:!1,id:null})}catch(t){console.error(t),o("error",t instanceof Error?t.message:"Impossible de supprimer le slide")}finally{w(!1)}}},q=t=>{const s=t.target.files?.[0];if(s){k(s);const a=new FileReader;a.onloadend=()=>{h(a.result)},a.readAsDataURL(s)}};return e.jsxs("div",{className:"flex flex-col gap-6 p-4",children:[e.jsx(H,{title:"Slides Carrousel"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm uppercase tracking-wide text-gray-500",children:"Apparence"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Slides du Carrousel"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Gérer les slides affichés sur la page d'accueil."})]}),e.jsxs("button",{onClick:()=>{m(),d(!0)},className:"inline-flex items-center gap-2 rounded-lg bg-[#03800a] px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-[#166e7b]",children:[e.jsx(G,{className:"h-4 w-4"}),"Nouveau slide"]})]}),e.jsx("div",{className:"rounded-xl border border-gray-200 bg-white p-0 shadow-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-left text-xs uppercase text-gray-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:"Image"}),e.jsx("th",{className:"px-4 py-3",children:"Titre"}),e.jsx("th",{className:"px-4 py-3",children:"Ordre"}),e.jsx("th",{className:"px-4 py-3",children:"Actif"}),e.jsx("th",{className:"px-4 py-3",children:"Actions"})]})}),e.jsx("tbody",{children:D?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-4 text-center text-gray-500",children:"Chargement..."})}):b.length?b.map(t=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-3",children:t.image_url?e.jsxs("button",{onClick:()=>S({open:!0,url:t.image_url,title:t.title||"Slide"}),className:"relative group cursor-pointer",title:"Cliquer pour agrandir",children:[e.jsx("img",{src:t.image_url,alt:t.title||"Slide",className:"h-12 w-20 rounded object-cover bg-gray-100 transition-all group-hover:ring-2 group-hover:ring-blue-500 group-hover:ring-offset-2",onError:s=>{console.error("Image failed to load:",t.image_url);const a=s.target;a.style.display="none";const c=a.parentElement;c&&(c.innerHTML='<div class="flex h-12 w-20 items-center justify-center rounded bg-red-50 text-xs text-red-600 p-1 text-center">Erreur</div>')}}),e.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity rounded flex items-center justify-center",children:e.jsx("svg",{className:"h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"})})})]}):e.jsx("div",{className:"flex h-12 w-20 items-center justify-center rounded bg-gray-100",children:e.jsx(J,{className:"h-6 w-6 text-gray-400"})})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.title||"—"}),t.subtitle&&e.jsx("div",{className:"text-xs text-gray-500",children:t.subtitle})]}),e.jsx("td",{className:"px-4 py-3 text-gray-700",children:t.ordre}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`inline-flex rounded-full px-2 py-1 text-xs font-semibold ${t.actif?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:t.actif?"Actif":"Inactif"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>F(t),className:"rounded p-1 text-blue-600 hover:bg-blue-50",title:"Éditer",children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>P(t.id),className:"rounded p-1 text-red-600 hover:bg-red-50",title:"Supprimer",children:e.jsx($,{className:"h-4 w-4"})})]})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-6 text-center text-gray-500",children:"Aucun slide pour le moment."})})})]})})}),A&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:e.jsxs("div",{className:"max-h-[90vh] w-full max-w-2xl overflow-y-auto rounded-2xl bg-white shadow-2xl",children:[e.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-6 py-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:n?"Éditer le slide":"Nouveau slide"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:n?"Modifier un slide":"Créer un slide"})]}),e.jsx("button",{className:"rounded-full p-2 text-gray-500 hover:bg-gray-100",onClick:()=>{d(!1),m()},children:e.jsx(W,{className:"h-5 w-5"})})]}),e.jsxs("form",{className:"space-y-4 px-6 py-5",onSubmit:M,children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Titre"}),e.jsx("input",{value:r.title,onChange:t=>i({...r,title:t.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-[#03800a]/20",placeholder:"Titre principal du slide"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Sous-titre"}),e.jsx("input",{value:r.subtitle,onChange:t=>i({...r,subtitle:t.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-[#03800a]/20",placeholder:"Sous-titre"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Texte en surbrillance (orange)"}),e.jsx("input",{value:r.highlight,onChange:t=>i({...r,highlight:t.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-[#03800a]/20",placeholder:"Texte mis en évidence"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{value:r.description,onChange:t=>i({...r,description:t.target.value}),rows:3,className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-[#03800a]/20",placeholder:"Description du slide"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Texte du bouton"}),e.jsx("input",{value:r.cta_text,onChange:t=>i({...r,cta_text:t.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-[#03800a]/20",placeholder:"Ex: Découvrir"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Lien du bouton"}),e.jsx("input",{value:r.cta_link,onChange:t=>i({...r,cta_link:t.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-[#03800a]/20",placeholder:"URL ou #section"})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Ordre d'affichage"}),e.jsx("input",{type:"number",min:"0",value:r.ordre,onChange:t=>i({...r,ordre:t.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-[#03800a]/20"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Plus petit = affiché en premier"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Statut"}),e.jsxs("select",{value:r.actif?"1":"0",onChange:t=>i({...r,actif:t.target.value==="1"}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-[#03800a]/20",children:[e.jsx("option",{value:"1",children:"Actif"}),e.jsx("option",{value:"0",children:"Inactif"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Image ",n?"":"*"]}),e.jsx("input",{type:"file",accept:"image/*",required:!n,onChange:q,className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-[#03800a]/20"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Formats image, max 4 Mo."}),E&&e.jsx("div",{className:"mt-3",children:e.jsx("img",{src:E,alt:"Aperçu",className:"h-40 w-full rounded-lg object-cover"})})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 border-t pt-4",children:[e.jsx("button",{type:"button",className:"rounded-lg px-4 py-2 text-sm font-semibold text-gray-600 hover:bg-gray-100",onClick:()=>{d(!1),m()},children:"Annuler"}),e.jsx("button",{type:"submit",disabled:y,className:"rounded-lg bg-[#03800a] px-5 py-2 text-sm font-semibold text-white shadow-sm hover:bg-[#166e7b] disabled:opacity-60",children:y?"Enregistrement...":"Enregistrer"})]})]})]})}),e.jsx(K,{open:x.open,onClose:()=>p({open:!1,id:null}),onConfirm:R,title:"Supprimer ce slide ?",message:"Cette action est irréversible. Le slide sera définitivement supprimé.",confirmText:"Supprimer",type:"danger",loading:L}),e.jsx(B,{open:g.open,onClose:()=>S({open:!1,url:"",title:""}),imageUrl:g.url,title:g.title})]})};V.layout=o=>e.jsx(U,{children:o});export{V as default};
