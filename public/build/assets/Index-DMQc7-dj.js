import{u as U,r as n,j as e,H as B}from"./app-D6kKXF99.js";import{l as p,a as $,L as z}from"./listing-DkE4S9r-.js";import{L as K}from"./ListingToolbar-DdN-fM3Z.js";import{A as V}from"./app-layout-C2jjdTT_.js";import{u as W}from"./use-listing-search-Cfe9cgMd.js";import{u as G,X as J}from"./NotificationContainer-BT-c5sXX.js";import{T as Q,C as Y}from"./ConfirmDialog-aofYRKw4.js";import{R as Z}from"./RichTextEditor-DgllcQCl.js";import{P as ee}from"./plus-UnDe78EH.js";import{S as se}from"./square-pen-CKOLoaH4.js";/* empty css            */import"./utils-ALYWs1Gd.js";import"./index-DCUGYyOh.js";import"./button-B5k_BnNa.js";import"./index-BpwMDNmh.js";import"./index-VjNSY46-.js";import"./index-CjaKH9ar.js";import"./index-Fv__CLny.js";import"./proxy-hi-s8ZU_.js";import"./index-w_94M6Cx.js";import"./index-CMWG4mbA.js";import"./book-open-DKjhm4ZH.js";import"./megaphone-Cbc3w7gv.js";import"./landmark-Cm81SObB.js";import"./tag-2FDY3cPo.js";import"./users-DcN1oeZo.js";import"./chevron-right-DvLDHTaz.js";const re=[{value:"",label:"Aucune"},{value:"FileText",label:"Document"},{value:"Users",label:"Utilisateurs"},{value:"Building",label:"Bâtiment"},{value:"Home",label:"Maison"},{value:"Sprout",label:"Nature"},{value:"Heart",label:"Social"},{value:"Briefcase",label:"Portefeuille"},{value:"Coins",label:"Finances"},{value:"Calendar",label:"Agenda"},{value:"MapPin",label:"Localisation"},{value:"PhoneCall",label:"Contacts"}],ae=({directions:x=[],listing:g})=>{const{addNotification:f}=G(),{url:F}=U(),i=F.split("?")[0],[b,L]=n.useState(g?.filters.search??""),j=g?.filters.sort??"ordre",y=g?.filters.direction??"asc",d=g?.pagination??{page:1,per_page:15,total:x.length,last_page:1},l=n.useMemo(()=>({search:b,sort:j,direction:y,per_page:d.per_page}),[d.per_page,b,y,j]);W(i,l);const[R,m]=n.useState(!1),[k,S]=n.useState(!1),[u,D]=n.useState(null),[_,v]=n.useState({open:!1,id:null}),[O,E]=n.useState(!1),[r,t]=n.useState({nom:"",short_description:"",contenu:"",icon:"",responsable:"",fonction_responsable:"",adresse:"",ordre:"0",actif:!0,biographie_responsable:"",reseaux_sociaux_facebook:"",reseaux_sociaux_twitter:"",reseaux_sociaux_linkedin:"",reseaux_sociaux_instagram:""}),[P,N]=n.useState(null),[A,w]=n.useState(null),h=()=>{t({nom:"",short_description:"",contenu:"",icon:"",responsable:"",fonction_responsable:"",adresse:"",ordre:"0",actif:!0,biographie_responsable:"",reseaux_sociaux_facebook:"",reseaux_sociaux_twitter:"",reseaux_sociaux_linkedin:"",reseaux_sociaux_instagram:""}),N(null),w(null),D(null)},T=s=>{t({nom:s.nom??"",short_description:s.short_description??s.description??"",contenu:s.contenu??"",icon:s.icon??"",responsable:s.responsable??"",fonction_responsable:s.fonction_responsable??"",adresse:s.adresse??"",ordre:String(s.ordre??0),actif:s.actif??!0,biographie_responsable:s.biographie_responsable??"",reseaux_sociaux_facebook:s.reseaux_sociaux_responsable?.facebook??"",reseaux_sociaux_twitter:s.reseaux_sociaux_responsable?.twitter??"",reseaux_sociaux_linkedin:s.reseaux_sociaux_responsable?.linkedin??"",reseaux_sociaux_instagram:s.reseaux_sociaux_responsable?.instagram??""}),N(null),w(s.photo_responsable_url??null),D(s.id),m(!0)},q=async s=>{s.preventDefault(),S(!0);try{const o=document.querySelector('meta[name="csrf-token"]')?.content??"",a=new FormData;a.append("nom",r.nom),a.append("description",r.short_description),a.append("short_description",r.short_description),a.append("contenu",r.contenu),r.icon&&a.append("icon",r.icon),r.responsable&&a.append("responsable",r.responsable),r.fonction_responsable&&a.append("fonction_responsable",r.fonction_responsable),r.adresse&&a.append("adresse",r.adresse),a.append("ordre",String(Number(r.ordre||0))),a.append("actif",r.actif?"1":"0"),r.biographie_responsable&&a.append("biographie_responsable",r.biographie_responsable),P&&a.append("photo_responsable",P);const c={};r.reseaux_sociaux_facebook&&(c.facebook=r.reseaux_sociaux_facebook),r.reseaux_sociaux_twitter&&(c.twitter=r.reseaux_sociaux_twitter),r.reseaux_sociaux_linkedin&&(c.linkedin=r.reseaux_sociaux_linkedin),r.reseaux_sociaux_instagram&&(c.instagram=r.reseaux_sociaux_instagram),Object.keys(c).length>0&&a.append("reseaux_sociaux_responsable",JSON.stringify(c));const X=u?`/admin/api/directions/${u}`:"/admin/api/directions";u&&a.append("_method","PUT");const C=await fetch(X,{method:"POST",headers:{"X-CSRF-TOKEN":o,"X-Requested-With":"XMLHttpRequest"},body:a});if(!C.ok){const H=await C.json();throw new Error(H.message||"Erreur de sauvegarde")}const M=await C.json();f("success",M.message||(u?"Direction mise à jour":"Direction créée")),m(!1),h(),p(i,{...l,page:1})}catch(o){console.error(o),f("error",o instanceof Error?o.message:"Impossible de sauvegarder la direction")}finally{S(!1)}},I=async()=>{if(_.id){E(!0);try{const s=document.querySelector('meta[name="csrf-token"]')?.content??"",o=await fetch(`/admin/api/directions/${_.id}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":s,"X-Requested-With":"XMLHttpRequest"}});if(!o.ok){const c=await o.json();throw new Error(c.message||"Erreur de suppression")}const a=await o.json();f("success",a.message||"Direction supprimée"),v({open:!1,id:null}),p(i,l)}catch(s){console.error(s),f("error",s instanceof Error?s.message:"Impossible de supprimer la direction")}finally{E(!1)}}};return e.jsxs("div",{className:"flex flex-col gap-6 p-4",children:[e.jsx(B,{title:"Directions"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm uppercase tracking-wide text-gray-500",children:"Organisation"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Directions"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Gérez les directions et leurs descriptions (courte + détaillée)."})]}),e.jsxs("button",{onClick:()=>{h(),m(!0)},className:"inline-flex items-center gap-2 rounded-lg bg-[#03800a] px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-700",children:[e.jsx(ee,{className:"h-4 w-4"}),"Nouvelle direction"]})]}),e.jsx(K,{search:b,perPage:d.per_page,sort:{value:j,direction:y},sortOptions:[{value:"ordre",label:"Ordre"},{value:"nom",label:"Nom"},{value:"created_at",label:"Créé le"}],onSearchChange:L,onSearchSubmit:()=>p(i,{...l,page:1}),onPerPageChange:s=>p(i,{...l,per_page:s,page:1}),onExport:s=>$(i,l,s),onSortChange:(s,o)=>p(i,{...l,sort:s,direction:o})}),e.jsx("div",{className:"rounded-xl border border-gray-200 bg-white shadow-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-left text-xs uppercase text-gray-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:"Nom"}),e.jsx("th",{className:"px-4 py-3",children:"Responsable"}),e.jsx("th",{className:"px-4 py-3",children:"Ordre"}),e.jsx("th",{className:"px-4 py-3",children:"Statut"}),e.jsx("th",{className:"px-4 py-3",children:"Actions"})]})}),e.jsx("tbody",{children:x.length?x.map(s=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:s.nom}),e.jsx("td",{className:"px-4 py-3 text-gray-700",children:s.responsable??"—"}),e.jsx("td",{className:"px-4 py-3 text-gray-700",children:s.ordre??0}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`inline-flex rounded-full px-2 py-1 text-xs font-semibold ${s.actif?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:s.actif?"Actif":"Inactif"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>T(s),className:"rounded p-2 text-blue-600 hover:bg-blue-50",title:"Éditer",children:e.jsx(se,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>v({open:!0,id:s.id}),className:"rounded p-2 text-red-600 hover:bg-red-50",title:"Supprimer",children:e.jsx(Q,{className:"h-4 w-4"})})]})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-6 text-center text-gray-500",children:"Aucune direction pour le moment."})})})]})})}),e.jsx(z,{page:d.page,lastPage:d.last_page,total:d.total,onPageChange:s=>p(i,{...l,page:s})}),R&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center bg-black/40 px-4 py-6 overflow-y-auto",children:e.jsxs("div",{className:"w-full max-w-3xl rounded-2xl bg-white shadow-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between border-b px-6 py-4",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:[u?"Modifier":"Nouvelle"," direction"]}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:u?"Modifier la direction":"Ajouter une direction"})]}),e.jsx("button",{onClick:()=>{m(!1),h()},className:"rounded-full p-2 text-gray-500 hover:bg-gray-100",children:e.jsx(J,{className:"h-5 w-5"})})]}),e.jsxs("form",{className:"space-y-4 px-6 py-5",onSubmit:q,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Nom *"}),e.jsx("input",{required:!0,value:r.nom,onChange:s=>t({...r,nom:s.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-green-200",placeholder:"Ex: Direction des Affaires Administratives"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Responsable"}),e.jsx("input",{value:r.responsable,onChange:s=>t({...r,responsable:s.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-green-200",placeholder:"Nom et prénom"})]})]}),r.responsable&&e.jsxs("div",{className:"col-span-1 md:col-span-2 border-t border-gray-100 pt-4 mt-1",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-800 mb-3",children:"Profil du responsable"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Fonction"}),e.jsx("input",{value:r.fonction_responsable,onChange:s=>t({...r,fonction_responsable:s.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-green-200",placeholder:"Ex: Directeur, Directrice, Chef de service..."})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Photo du responsable"}),e.jsxs("div",{className:"mt-1 flex items-center gap-4",children:[A&&e.jsx("img",{src:A,alt:"Apercu",className:"w-16 h-16 rounded-full object-cover border-2 border-orange-200"}),e.jsx("input",{type:"file",accept:"image/*",onChange:s=>{const o=s.target.files?.[0];o&&(N(o),w(URL.createObjectURL(o)))},className:"text-sm text-gray-600"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Biographie"}),e.jsx("textarea",{value:r.biographie_responsable,onChange:s=>t({...r,biographie_responsable:s.target.value}),rows:4,className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-green-200",placeholder:"Biographie du responsable..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Facebook"}),e.jsx("input",{value:r.reseaux_sociaux_facebook,onChange:s=>t({...r,reseaux_sociaux_facebook:s.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-green-200",placeholder:"https://facebook.com/..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Twitter / X"}),e.jsx("input",{value:r.reseaux_sociaux_twitter,onChange:s=>t({...r,reseaux_sociaux_twitter:s.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-green-200",placeholder:"https://twitter.com/..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"LinkedIn"}),e.jsx("input",{value:r.reseaux_sociaux_linkedin,onChange:s=>t({...r,reseaux_sociaux_linkedin:s.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-green-200",placeholder:"https://linkedin.com/in/..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Instagram"}),e.jsx("input",{value:r.reseaux_sociaux_instagram,onChange:s=>t({...r,reseaux_sociaux_instagram:s.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-green-200",placeholder:"https://instagram.com/..."})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Description courte"}),e.jsx("input",{value:r.short_description,onChange:s=>t({...r,short_description:s.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-green-200",placeholder:"Résumé court pour les cartes"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Description détaillée"}),e.jsx(Z,{value:r.contenu,onChange:s=>t({...r,contenu:s})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Icône"}),e.jsx("select",{value:r.icon,onChange:s=>t({...r,icon:s.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-green-200",children:re.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Adresse"}),e.jsx("input",{value:r.adresse,onChange:s=>t({...r,adresse:s.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-green-200",placeholder:"Adresse ou localisation"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Ordre"}),e.jsx("input",{type:"number",min:"0",value:r.ordre,onChange:s=>t({...r,ordre:s.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#03800a] focus:outline-none focus:ring-2 focus:ring-green-200"})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-6",children:[e.jsx("input",{type:"checkbox",id:"actif",checked:r.actif,onChange:s=>t({...r,actif:s.target.checked}),className:"h-4 w-4 rounded border-gray-300 text-[#03800a] focus:ring-[#03800a]"}),e.jsx("label",{htmlFor:"actif",className:"text-sm font-medium text-gray-700",children:"Actif (visible sur le site)"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 border-t pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{m(!1),h()},className:"rounded-lg px-4 py-2 text-sm font-semibold text-gray-600 hover:bg-gray-100",children:"Annuler"}),e.jsx("button",{type:"submit",disabled:k,className:"rounded-lg bg-[#03800a] px-5 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-700 disabled:opacity-60",children:k?"Enregistrement...":"Enregistrer"})]})]})]})}),e.jsx(Y,{open:_.open,onClose:()=>v({open:!1,id:null}),onConfirm:I,title:"Supprimer cette direction ?",message:"Cette action est irréversible. La direction sera définitivement supprimée.",confirmText:"Supprimer",type:"danger",loading:O})]})};ae.layout=x=>e.jsx(V,{children:x});export{ae as default};
