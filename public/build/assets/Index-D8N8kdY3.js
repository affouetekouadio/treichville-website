import{r as a,j as e,H as E}from"./app-Dt7RuvZJ.js";import{A as _}from"./app-layout-CDHZc0iB.js";import{R as L}from"./RichTextEditor-B-_9vRJy.js";import{P as R}from"./plus-eH69TIOW.js";import{X as k}from"./NotificationContainer-CTXYxmtc.js";/* empty css            */import"./utils-B_eCRiuR.js";import"./button-C1KOq0LB.js";import"./index-CyM1ERZV.js";import"./index-BTe_yMI_.js";import"./proxy-CvMQ_CUX.js";import"./index-2yvp8cuD.js";import"./index-CMWG4mbA.js";import"./megaphone-j6sGbgaP.js";import"./tag-gBy1bOOH.js";import"./book-open-2cfZ-n7i.js";import"./chevron-right-C4oXrUTZ.js";const F=()=>{const[i,u]=a.useState([]),[y,b]=a.useState(!0),[v,o]=a.useState(!1),[x,p]=a.useState(!1),[N,w]=a.useState([]),[s,n]=a.useState({titre:"",categorie:"",category_id:"",status:"published",date_debut:"",lieu:"",description:"",contenu:""}),[f,g]=a.useState(null),[h,j]=a.useState("");a.useEffect(()=>{(async()=>{try{const l=await(await fetch("/admin/api/evenements")).json();u(l.data||[]);const d=await(await fetch("/admin/api/categories?type=evenement")).json();w(d.data||[])}catch(r){console.error(r)}finally{b(!1)}})()},[]);const C=async t=>{t.preventDefault(),p(!0);try{const r=document.querySelector('meta[name="csrf-token"]')?.content??"",l=new FormData;Object.entries(s).forEach(([m,S])=>l.append(m,S??"")),f&&l.append("image",f);const c=await fetch("/admin/api/evenements",{method:"POST",headers:{"X-CSRF-TOKEN":r,"X-Requested-With":"XMLHttpRequest"},body:l});if(!c.ok)throw new Error("Erreur de création");const d=await c.json();u(m=>[d.data,...m]),o(!1),n({titre:"",categorie:"",category_id:"",status:"published",date_debut:"",lieu:"",description:"",contenu:""}),g(null),j("")}catch(r){console.error(r),alert("Impossible de créer l'événement. Vérifie les champs obligatoires.")}finally{p(!1)}};return e.jsxs("div",{className:"flex flex-col gap-6 p-4",children:[e.jsx(E,{title:"Événements"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm uppercase tracking-wide text-gray-500",children:"Contenu"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Événements"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Liste des événements à jour. Ajouter/éditer à connecter ensuite."})]}),e.jsxs("button",{onClick:()=>o(!0),className:"inline-flex items-center gap-2 rounded-lg bg-[#f8812f] px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-orange-600",children:[e.jsx(R,{className:"h-4 w-4"}),"Nouvel événement"]})]}),e.jsx("div",{className:"rounded-xl border border-gray-200 bg-white p-0 shadow-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-left text-xs uppercase text-gray-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:"Titre"}),e.jsx("th",{className:"px-4 py-3",children:"Catégorie"}),e.jsx("th",{className:"px-4 py-3",children:"Lieu"}),e.jsx("th",{className:"px-4 py-3",children:"Date"}),e.jsx("th",{className:"px-4 py-3",children:"Statut"})]})}),e.jsx("tbody",{children:y?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-4 text-center text-gray-500",children:"Chargement..."})}):i.length?i.map(t=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:t.titre}),e.jsx("td",{className:"px-4 py-3 text-gray-700",children:t.categorie||"—"}),e.jsx("td",{className:"px-4 py-3 text-gray-700",children:t.lieu||"—"}),e.jsx("td",{className:"px-4 py-3 text-gray-700",children:t.date_debut?new Date(t.date_debut).toLocaleDateString():"—"}),e.jsx("td",{className:"px-4 py-3 text-gray-700",children:t.status||"draft"})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-6 text-center text-gray-500",children:"Aucun événement pour le moment."})})})]})})}),v&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:e.jsxs("div",{className:"w-full max-w-2xl rounded-2xl bg-white shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between border-b px-6 py-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Nouvel événement"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Créer un événement"})]}),e.jsx("button",{className:"rounded-full p-2 text-gray-500 hover:bg-gray-100",onClick:()=>o(!1),children:e.jsx(k,{className:"h-5 w-5"})})]}),e.jsxs("form",{className:"space-y-4 px-6 py-5",onSubmit:C,children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Titre *"}),e.jsx("input",{required:!0,value:s.titre,onChange:t=>n({...s,titre:t.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#f8812f] focus:outline-none focus:ring-2 focus:ring-[#f8812f]/20",placeholder:"Titre de l’événement"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Catégorie"}),e.jsxs("select",{value:s.category_id,onChange:t=>n({...s,category_id:t.target.value,categorie:""}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#f8812f] focus:outline-none focus:ring-2 focus:ring-[#f8812f]/20",children:[e.jsx("option",{value:"",children:"Sélectionner"}),N.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Catégories limitées au type Événement."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Date de début"}),e.jsx("input",{type:"datetime-local",value:s.date_debut,onChange:t=>n({...s,date_debut:t.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#f8812f] focus:outline-none focus:ring-2 focus:ring-[#f8812f]/20"})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Lieu"}),e.jsx("input",{value:s.lieu,onChange:t=>n({...s,lieu:t.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#f8812f] focus:outline-none focus:ring-2 focus:ring-[#f8812f]/20",placeholder:"Ex: Esplanade de la mairie"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Statut"}),e.jsxs("select",{value:s.status,onChange:t=>n({...s,status:t.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#f8812f] focus:outline-none focus:ring-2 focus:ring-[#f8812f]/20",children:[e.jsx("option",{value:"published",children:"Publié"}),e.jsx("option",{value:"draft",children:"Brouillon"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Description courte"}),e.jsx("textarea",{value:s.description,onChange:t=>n({...s,description:t.target.value}),rows:3,className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#f8812f] focus:outline-none focus:ring-2 focus:ring-[#f8812f]/20",placeholder:"Résumé affiché sur la carte"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Contenu détaillé (CKEditor)"}),e.jsx(L,{value:s.contenu,onChange:t=>n({...s,contenu:t}),placeholder:"Programme, intervenants, détails pratiques..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Image principale"}),e.jsx("input",{type:"file",accept:"image/*",onChange:t=>{const r=t.target.files?.[0]??null;g(r),j(r?URL.createObjectURL(r):"")},className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-[#f8812f] focus:outline-none focus:ring-2 focus:ring-[#f8812f]/20"}),h&&e.jsx("div",{className:"mt-3 overflow-hidden rounded-xl border border-gray-200 bg-gray-50",children:e.jsx("img",{src:h,alt:"Prévisualisation",className:"h-40 w-full object-cover"})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Formats image, max 4 Mo."})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 border-t pt-4",children:[e.jsx("button",{type:"button",className:"rounded-lg px-4 py-2 text-sm font-semibold text-gray-600 hover:bg-gray-100",onClick:()=>o(!1),children:"Annuler"}),e.jsx("button",{type:"submit",disabled:x,className:"rounded-lg bg-[#f8812f] px-5 py-2 text-sm font-semibold text-white shadow-sm hover:bg-orange-600 disabled:opacity-60",children:x?"Enregistrement...":"Enregistrer"})]})]})]})})]})};F.layout=i=>e.jsx(_,{children:i});export{F as default};
