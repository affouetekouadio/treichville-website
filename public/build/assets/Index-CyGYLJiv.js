import{u as w,r as i,j as e,H as C}from"./app-K77AxUKY.js";import{l as c,a as S,L as P}from"./listing-BfKhte1D.js";import{L as E}from"./ListingToolbar-D3A7TJ36.js";import{A as _}from"./app-layout-CUD6Znmh.js";import{u as A}from"./use-listing-search-BkQ_bnai.js";import{P as k}from"./plus-DO7HKNtk.js";import{X as L}from"./NotificationContainer--G8KX6BI.js";/* empty css            */import"./utils-BRVl_mYo.js";import"./button-BiTH8gZ1.js";import"./index-DXeLTEri.js";import"./index-mVHEAQOY.js";import"./proxy-oiS1Qu__.js";import"./index-w_94M6Cx.js";import"./index-CMWG4mbA.js";import"./book-open-DHc9VyfV.js";import"./megaphone-DogHLWj5.js";import"./landmark-C9IeD2Ba.js";import"./tag-2xWwbODa.js";import"./users-BwOv4Pbi.js";import"./chevron-right-5bzEVtF7.js";const T=({categories:l=[],listing:p})=>{const{url:j}=w(),s=j.split("?")[0],[d,b]=i.useState(p?.filters.search??""),x=p?.filters.sort??"name",u=p?.filters.direction??"asc",r=p?.pagination??{page:1,per_page:15,total:l.length,last_page:1},a=i.useMemo(()=>({search:d,sort:x,direction:u,per_page:r.per_page}),[r.per_page,d,u,x]);A(s,a);const[N,m]=i.useState(!1),[h,f]=i.useState(!1),[o,g]=i.useState({name:"",type:"actualite"}),v=async t=>{t.preventDefault(),f(!0);try{const n=document.querySelector('meta[name="csrf-token"]')?.content??"",y=await fetch("/admin/api/categories",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",Accept:"application/json","X-CSRF-TOKEN":n},credentials:"same-origin",body:JSON.stringify(o)});if(!y.ok)throw new Error("Erreur création catégorie");await y.json(),m(!1),g({name:"",type:"actualite"}),c(s,{...a,page:1})}catch(n){console.error(n),alert("Impossible de créer la catégorie.")}finally{f(!1)}};return e.jsxs("div",{className:"flex flex-col gap-6 p-4",children:[e.jsx(C,{title:"Catégories"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm uppercase tracking-wide text-gray-500",children:"Classification"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Catégories"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Gérez les catégories pour les actualités et les événements."})]}),e.jsxs("button",{onClick:()=>m(!0),className:"inline-flex items-center gap-2 rounded-lg bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-slate-800",children:[e.jsx(k,{className:"h-4 w-4"}),"Nouvelle catégorie"]})]}),e.jsx(E,{search:d,perPage:r.per_page,sort:{value:x,direction:u},sortOptions:[{value:"name",label:"Nom"},{value:"type",label:"Type"},{value:"created_at",label:"Date creation"}],onSearchChange:b,onSearchSubmit:()=>c(s,{...a,page:1}),onPerPageChange:t=>c(s,{...a,per_page:t,page:1}),onExport:t=>S(s,a,t),onSortChange:(t,n)=>c(s,{...a,sort:t,direction:n})}),e.jsx("div",{className:"rounded-xl border border-gray-200 bg-white p-0 shadow-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-left text-xs uppercase text-gray-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:"Nom"}),e.jsx("th",{className:"px-4 py-3",children:"Type"})]})}),e.jsx("tbody",{children:l.length?l.map(t=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:t.name}),e.jsx("td",{className:"px-4 py-3 text-gray-700",children:t.type==="actualite"?"Actualité":"Événement"})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"px-4 py-6 text-center text-gray-500",children:"Aucune catégorie pour le moment."})})})]})})}),e.jsx(P,{page:r.page,lastPage:r.last_page,total:r.total,onPageChange:t=>c(s,{...a,page:t})}),N&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:e.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between border-b px-6 py-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Nouvelle catégorie"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Ajouter"})]}),e.jsx("button",{className:"rounded-full p-2 text-gray-500 hover:bg-gray-100",onClick:()=>m(!1),children:e.jsx(L,{className:"h-5 w-5"})})]}),e.jsxs("form",{className:"space-y-4 px-6 py-5",onSubmit:v,children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Nom *"}),e.jsx("input",{required:!0,value:o.name,onChange:t=>g({...o,name:t.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-200",placeholder:"Ex: Institutionnel, Culture..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Type *"}),e.jsxs("select",{value:o.type,onChange:t=>g({...o,type:t.target.value}),className:"mt-1 w-full rounded-lg border border-gray-200 px-3 py-2 focus:border-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-200",children:[e.jsx("option",{value:"actualite",children:"Actualité"}),e.jsx("option",{value:"evenement",children:"Événement"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 border-t pt-4",children:[e.jsx("button",{type:"button",className:"rounded-lg px-4 py-2 text-sm font-semibold text-gray-600 hover:bg-gray-100",onClick:()=>m(!1),children:"Annuler"}),e.jsx("button",{type:"submit",disabled:h,className:"rounded-lg bg-slate-900 px-5 py-2 text-sm font-semibold text-white shadow-sm hover:bg-slate-800 disabled:opacity-60",children:h?"Enregistrement...":"Enregistrer"})]})]})]})})]})};T.layout=l=>e.jsx(_,{children:l});export{T as default};
